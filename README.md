# HCS - Hardening & Compliance System

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è Enterprise-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Compliance & Hardening).

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–ú—É–ª—å—Ç–∏–≤–µ–Ω–¥–æ—Ä–Ω–æ—Å—Ç—å:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Cisco (IOS/NX-OS/XR), Juniper, Arista, Eltex, Huawei.
*   **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:**
    *   **GitLab/Git:** –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.
    *   **SSH:** –ü—Ä—è–º–æ–π —Å–±–æ—Ä `show run` —á–µ—Ä–µ–∑ Netmiko.
    *   **NETCONF/SNMP:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ legacy –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.
    *   **API:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏.
*   **–ú–æ—â–Ω—ã–π –¥–≤–∏–∂–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫:**
    *   –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (Regex).
    *   –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–ª–æ–∫–æ–≤ (Interfaces, VLANs).
    *   –¢–µ–∫—Å—Ç–æ–≤–æ–π –ø–∞—Ä—Å–∏–Ω–≥ (TextFSM) –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ç–∞–±–ª–∏—Ü (show commands).
    *   –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (JSON/XML/XPath).
*   **Remediation:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Ansible Playbooks –∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ (AWX/Tower, SSH).
*   **–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å:** Dashboard, Compliance Matrix, CSV Exports.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **Backend:** Python 3.11, Flask, SQLAlchemy.
*   **Database:** PostgreSQL, Redis.
*   **Async Interface:** Celery (Parallel scanning).
*   **Frontend:** Jinja2, Vanilla JS, Tailwind-like CSS variables.

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
*   Docker & Docker Compose
*   Python 3.11+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

1.  **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
    ```bash
    git clone https://github.com/your-org/hcs.git
    cd hcs
    ```

2.  **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
    ```bash
    cp .env.example .env
    # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env, —É–∫–∞–∑–∞–≤ –¥–æ—Å—Ç—É–ø—ã –∫ –ë–î, Redis –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏
    ```

3.  **–ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
    ```bash
    docker-compose up -d postgres redis
    ```

4.  **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
    ```bash
    flask db upgrade
    flask seed  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∑–∞–≥—Ä—É–∑–∫–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
    ```

5.  **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤:**
    ```bash
    # –¢–µ—Ä–º–∏–Ω–∞–ª 1: Web UI & API
    flask run --host=0.0.0.0

    # –¢–µ—Ä–º–∏–Ω–∞–ª 2: Celery Worker
    celery -A app.extensions.celery worker --loglevel=info
    ```

## üïπ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ Web UI

–û—Ç–∫—Ä–æ–π—Ç–µ **Settings** (–∏–∫–æ–Ω–∫–∞ ‚öôÔ∏è –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏):

#### Data Sources (–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π)
–û—Ç–∫—É–¥–∞ HCS –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤:
*   **GitLab**: URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, Project ID, Token (read_api), —à–∞–±–ª–æ–Ω –ø—É—Ç–∏.
*   **SSH**: Netmiko device type, username, port, –∫–æ–º–∞–Ω–¥–∞ (`show run`).
    *   *ProxyJump*: –£–∫–∞–∂–∏—Ç–µ `ssh_config_file` –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ Bastion host.
*   **NETCONF**: IP, Port (830), User/Pass.
*   **Local**: –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –∫–æ–Ω—Ñ–∏–≥–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/app/configs`).

#### Inventory Sources (–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è)
–û—Ç–∫—É–¥–∞ HCS –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:
*   **PostgreSQL Database**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –≤–Ω–µ—à–Ω–µ–π CMDB.
*   **REST API**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ HTTP.
*   **Static**: –†—É—á–Ω–æ–π —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

> **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –í UI —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `GITLAB_TOKEN`).

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ansible (Remediation)
–î–ª—è —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ "Fix It":
1.  **AWX (Tower)**: –£–∫–∞–∂–∏—Ç–µ `AWX_URL` –∏ `AWX_TOKEN` –≤ `.env`. –í UI –ø–æ—è–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞—Ç—å Job Templates.
2.  **SSH**: –£–∫–∞–∂–∏—Ç–µ —Ö–æ—Å—Ç Ansible-—Å–µ—Ä–≤–µ—Ä–∞ –≤ `.env`. HCS –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å playbooks –≤ `/tmp/hcs` –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å `ansible-playbook`.

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Rule Builder** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫.
*   –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: `Simple Match`
*   –î–ª—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö (interface/router bgp): `Advanced Block`
*   –î–ª—è –≤–µ—Ä—Å–∏–π –ü–û: `Version Check`

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------------|----------|--------|
| `DATABASE_URL` | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL | `postgresql://user:pass@localhost:5432/hcs` |
| `CELERY_BROKER_URL` | Redis URL | `redis://localhost:6379/0` |
| `ANSIBLE_EXECUTOR_TYPE` | –†–µ–∂–∏–º Ansible (`local`, `awx`, `ssh`) | `awx` |
| `AWX_URL` | URL Ansible Tower/AWX | `https://awx.example.com` |
| `GITLAB_TOKEN` | –¢–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Git | `glpat-xxxxxxxx` |

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

*   [–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª (Advanced Block)](docs/examples/advanced_block_rules.md)
*   [API Documentation](/api/docs) (Swagger UI) available on `/api/docs` endpoint if configured.

## License

MIT License.
